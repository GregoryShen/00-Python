# 2021/4/19

## 装饰器

1. 函数是什么, 函数对象可以被赋值给变量吗? 如果可以被赋值给变量这说明什么呢?

   函数是对象，可以，说明函数对象可以作为参数传递给函数，也可以作为结果返回

2. 如何获取一个函数的名字?（指用默认的属性或方法）

   `foo.__name__`

3. 装饰器的定义

   在函数运行期间动态增加一些功能，而不改变原有函数的定义

4. 装饰器的本质是什么

   装饰器的本质就是一个高阶函数

5. 定义一个装饰器log, 使得在调用now函数的时候打印“call now():"的日志
   def now():
       print('2015-3-25')

   ```python
   import functools
   
   >>> def log(func):
   ...     @functools.wraps(func)
   ...     def wrapper(*args, **kwargs):
   ...         print('call {}():'.format(func.__name__))
   ...         return func(*args, **kwargs)
   ...     return wrapper
   ...
   >>> @log
   ... def now():
   ...     print('Today is 4/19')
   ...
   >>> now()
   call now():
   Today is 4/19
   ```

   

6. 把@log放在now函数的定义处, 相当于什么, 并对这句话进行解释

   相当于 `now = log(now)`

   log 是一个装饰器，原来的 now 函数还存在，但 now 变量已经指向了 log(func) 的返回函数 即 wrapper， 现在调用 now 就相当于调用 wrapper, 所以会先打印一句话， 然后返回 now() 调用的结果

7. 再定义一个装饰器log,要求装饰器可以自定义log的文本

   ```python
   import functools
   import time
   
   >>> def log(text):
   ...     def decorator(func):
   ...         @functools.wraps(func)
   ...         def wrapper(*args, **kwargs):
   ...             print("{} {}():".format(text, func.__name__))
   ...             return func(*args, **kwargs)
   ...         return wrapper
   ...     return decorator
   ...
   >>> @log('带参数的装饰器')
   ... def now():
   ...     print("现在的时间是：{}".format(time.strftime("%Y%m%d %H%M%S", time.loca
   ltime())))
   ...
   >>> now()
   带参数的装饰器 now():
   现在的时间是：20210419 113021
   ```

   

8. 对于上题把@log放在now函数的定义处, 相当于什么, 并对这句话进行解释

   

9. 为什么要引入`functools.wraps`

10. 设计一个装饰器, 它可作用于任何函数上, 并打印该函数的执行时间

11. 写出一个@log的decorator，使它既支持：
   @log
   def f():
     pass
   又支持：
   @log('execute')
   def f():
     pass